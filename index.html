<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Builder v61 (Random Skins)</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Pacifico&family=Ruslan+Display&family=Montserrat:wght@600;800&family=Press+Start+2P&family=Lobster&family=Comfortaa:wght@700&display=swap" rel="stylesheet">
<style>
/* --- –î–ò–ó–ê–ô–ù –†–ï–î–ê–ö–¢–û–†–ê --- */
:root {
    --primary: #6c5ce7;
    --bg-editor: #f4f7f6;
    --card-bg: #ffffff;
    --text-main: #2d3436;
    --text-muted: #636e72;
    --gradient: linear-gradient(135deg, #6c5ce7, #a29bfe);
    --panel-w: 430px; 
}

* { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
body { font-family: 'Roboto', sans-serif; height: 100vh; display: flex; overflow: hidden; background: #dfe6e9; }

.editor-panel {
    width: var(--panel-w);
    background: var(--bg-editor);
    border-right: 1px solid #dcdde1;
    display: flex;
    flex-direction: column;
    z-index: 10;
    box-shadow: 5px 0 15px rgba(0,0,0,0.05);
}

.editor-header {
    padding: 20px;
    background: var(--gradient);
    color: #fff;
    box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3);
}
.editor-header h2 {
    font-family: 'Montserrat', sans-serif;
    font-size: 18px;
    margin: 0;
    font-weight: 800;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    gap: 10px;
}

.tabs {
    display: flex;
    background: #fff;
    padding: 0 10px;
    border-bottom: 1px solid #e0e0e0;
}
.tab {
    flex: 1;
    text-align: center;
    padding: 15px 0;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    border-bottom: 3px solid transparent;
    transition: 0.3s;
    text-transform: uppercase;
}
.tab:hover { color: var(--primary); background: #fdfdfd; }
.tab.active {
    color: var(--primary);
    border-bottom-color: var(--primary);
}

.settings-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}
.section { display: none; animation: fadeIn 0.3s; }
.section.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

.info-box {
    background: #e3f2fd;
    border-left: 4px solid #2196f3;
    color: #0d47a1;
    padding: 12px;
    border-radius: 4px;
    font-size: 12px;
    margin-bottom: 20px;
    line-height: 1.4;
}

.form-group { margin-bottom: 15px; }
.form-group label {
    display: block;
    font-size: 11px;
    font-weight: 700;
    color: var(--text-muted);
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.file-upload-row { display: flex; gap: 5px; }
.file-upload-row input[type="text"] { flex: 1; border-top-right-radius: 0; border-bottom-right-radius: 0; }
input[type="file"] { display: none; }
.btn-upload {
    background: #dfe6e9;
    border: 2px solid #e6e6e6;
    border-left: none;
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    padding: 0 12px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; transition: 0.2s;
}
.btn-upload:hover { background: #b2bec3; }

.form-group input, .form-group textarea, .form-group select {
    width: 100%; padding: 10px 12px; border: 2px solid #e6e6e6; border-radius: 8px;
    font-size: 14px; background: #fff; color: var(--text-main); transition: 0.2s;
    font-family: 'Roboto', sans-serif;
}
.form-group input:focus, .form-group textarea:focus, .form-group select:focus {
    border-color: var(--primary); box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
}
.form-group input[type="color"] { height: 40px; padding: 2px; cursor: pointer; }
.form-group input[type="range"] { cursor: pointer; }
.form-row { display: flex; gap: 10px; }

.q-item {
    background: var(--card-bg); border: none; border-left: 5px solid var(--primary);
    padding: 15px; border-radius: 8px; margin-bottom: 15px; position: relative;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: transform 0.2s;
}
.q-item:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

.q-label { display: block; font-size: 10px; font-weight: 800; text-transform: uppercase; margin-bottom: 4px; color: #b2bec3; }

.btn-remove-q {
    position: absolute; top: 5px; right: 8px; color: #ff7675; cursor: pointer;
    font-size: 20px; font-weight: bold; transition: 0.2s;
}
.btn-remove-q:hover { color: #d63031; transform: scale(1.2); }

.btn-add {
    width: 100%; padding: 12px; background: #fff; border: 2px dashed var(--primary);
    color: var(--primary); border-radius: 8px; cursor: pointer; font-weight: 700;
    text-transform: uppercase; font-size: 13px; transition: 0.2s;
}
.btn-add:hover { background: #f0f0ff; }

.editor-footer { padding: 20px; border-top: 1px solid #e0e0e0; background: #fff; }
.btn-generate {
    width: 100%; padding: 14px; background: var(--gradient); color: #fff; border: none;
    border-radius: 10px; font-size: 16px; font-weight: 700; cursor: pointer;
    text-transform: uppercase; letter-spacing: 1px;
    box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4); transition: 0.2s;
}
.btn-generate:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(108, 92, 231, 0.5); }
.btn-generate:active { transform: translateY(1px); }

.preview-area {
    flex: 1; background: #dfe6e9; padding: 20px; display: flex; align-items: center;
    justify-content: center; background-image: radial-gradient(#b2bec3 1px, transparent 1px);
    background-size: 20px 20px;
}
#game-preview-container {
    width: 960px; height: 540px; background: #fff; box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    border-radius: 12px; overflow: hidden;
}
#game-frame { width: 100%; height: 100%; border: none; }

.modal-overlay {
    position: fixed; inset: 0; background: rgba(45, 52, 54, 0.9); z-index: 1000;
    display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px);
}
.code-modal {
    background: #fff; padding: 30px; border-radius: 16px; width: 600px; max-width: 90%;
    display: flex; flex-direction: column; gap: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}
.code-modal h3 { font-family: 'Montserrat', sans-serif; color: var(--text-main); }
.code-modal textarea {
    width: 100%; height: 300px; font-family: 'Consolas', monospace; padding: 15px;
    font-size: 12px; background: #f1f2f6; border: none; border-radius: 8px; color: #2f3542;
}
.modal-btns { display: flex; justify-content: flex-end; gap: 10px; }
.modal-btns button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; }
.btn-close { background: #dfe4ea; color: #2f3542; }
.btn-copy { background: var(--primary); color: #fff; }

::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #b2bec3; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #636e72; }
</style>
</head>
<body>

<div class="editor-panel">
    <div class="editor-header">
        <h2>üéÆ –†–µ–¥–∞–∫—Ç–æ—Ä "–ü–æ–π–º–∞–π –ø—Ä–µ–¥–º–µ—Ç"</h2>
    </div>
    
    <div class="tabs">
        <div class="tab active" onclick="switchTab('content')">–í–æ–ø—Ä–æ—Å—ã</div>
        <div class="tab" onclick="switchTab('graphics')">–ì—Ä–∞—Ñ–∏–∫–∞</div>
        <div class="tab" onclick="switchTab('style')">–°—Ç–∏–ª—å</div>
        <div class="tab" onclick="switchTab('text')">–¢–µ–∫—Å—Ç—ã</div>
    </div>
    
    <div class="settings-content">
        <div id="tab-content" class="section active">
            <div class="info-box">
                ‚ÑπÔ∏è <b>–°–æ–≤–µ—Ç:</b> –ò –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ, –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å <b>—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é</b>.<br>
                <i>–ü—Ä–∏–º–µ—Ä –≤–µ—Ä–Ω—ã—Ö: –Ø–±–ª–æ–∫–æ, –ì—Ä—É—à–∞, –°–ª–∏–≤–∞</i>
            </div>
            <div id="questions-list"></div>
            <button class="btn-add" onclick="addQuestion()">+ –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
        </div>
        
        <div id="tab-graphics" class="section">
            <div class="form-group"><label>–ì–µ—Ä–æ–π</label><div class="file-upload-row"><input type="text" id="img-hero" placeholder="–°—Å—ã–ª–∫–∞ –∏–ª–∏ —Ñ–∞–π–ª" oninput="clearCache('hero'); u()"><label for="file-hero" class="btn-upload">üìÇ</label><input type="file" id="file-hero" accept="image/*" onchange="encodeImg(this, 'hero')"></div></div>
            <div class="form-group"><label>–ë–æ–º–±–∞</label><div class="file-upload-row"><input type="text" id="img-bomb" placeholder="–°—Å—ã–ª–∫–∞ –∏–ª–∏ —Ñ–∞–π–ª" oninput="clearCache('bomb'); u()"><label for="file-bomb" class="btn-upload">üìÇ</label><input type="file" id="file-bomb" accept="image/*" onchange="encodeImg(this, 'bomb')"></div></div>
            <div class="form-group"><label>–ñ–∏–∑–Ω–∏</label><div class="file-upload-row"><input type="text" id="img-life" placeholder="–°—Å—ã–ª–∫–∞ –∏–ª–∏ —Ñ–∞–π–ª" oninput="clearCache('life'); u()"><label for="file-life" class="btn-upload">üìÇ</label><input type="file" id="file-life" accept="image/*" onchange="encodeImg(this, 'life')"></div></div>
            
            <div class="info-box" style="margin-top:10px; background:#fff3cd; border-color:#ffc107; color:#856404;">
                ‚ö†Ô∏è <b>–í–∞–∂–Ω–æ:</b> –ö–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–∏–∂–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è <b>—Å–ª—É—á–∞–π–Ω–æ</b> –¥–ª—è –ª—é–±–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (–≤–µ—Ä–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ), —á—Ç–æ–±—ã –∑–∞–ø—É—Ç–∞—Ç—å –∏–≥—Ä–æ–∫–∞!
            </div>
            
            <div class="form-row">
                <div class="form-group" style="flex:1"><label>–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ (–í–∞—Ä–∏–∞–Ω—Ç 1)</label><div class="file-upload-row"><input type="text" id="img-skin1" oninput="clearCache('skin1'); u()"><label for="file-skin1" class="btn-upload">üìÇ</label><input type="file" id="file-skin1" accept="image/*" onchange="encodeImg(this, 'skin1')"></div></div>
                <div class="form-group" style="flex:1"><label>–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ (–í–∞—Ä–∏–∞–Ω—Ç 2)</label><div class="file-upload-row"><input type="text" id="img-skin2" oninput="clearCache('skin2'); u()"><label for="file-skin2" class="btn-upload">üìÇ</label><input type="file" id="file-skin2" accept="image/*" onchange="encodeImg(this, 'skin2')"></div></div>
            </div>
        </div>
        
        <div id="tab-style" class="section">
            <div class="form-row">
                <div class="form-group" style="flex:1">
                    <label style="color:var(--primary)">–°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è</label>
                    <input type="range" id="conf-speed" min="1" max="10" step="0.5" value="2" oninput="u()">
                </div>
                <div class="form-group" style="flex:1">
                    <label style="color:#0984e3">–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</label>
                    <input type="range" id="conf-freq" min="300" max="2000" step="100" value="900" style="direction: rtl" oninput="u()">
                    <div style="font-size:9px; color:#999">–í–ª–µ–≤–æ - —á–∞—â–µ, –í–ø—Ä–∞–≤–æ - —Ä–µ–∂–µ</div>
                </div>
            </div>
            
            <div class="form-group" style="background:#fff; border:2px solid #eee; padding:10px; border-radius:8px;">
                <label style="color:#2d3436; margin-bottom:10px; display:block; border-bottom:1px solid #eee; padding-bottom:5px;">üìê –†–∞–∑–º–µ—Ä—ã –∏ –ü–æ–∑–∏—Ü–∏—è</label>
                
                <div class="form-group">
                    <label>–†–∞–∑–º–µ—Ä –ì–ï–†–û–Ø: <span id="sd-hsize">150</span>px</label>
                    <input type="range" id="conf-hero-size" min="50" max="250" step="5" value="150" oninput="document.getElementById('sd-hsize').innerText=this.value;u()">
                </div>

                <div class="form-group">
                    <label>–†–∞–∑–º–µ—Ä –û–¢–í–ï–¢–û–í: <span id="sd-size">70</span>px</label>
                    <input type="range" id="conf-size" min="40" max="150" step="5" value="70" oninput="document.getElementById('sd-size').innerText=this.value;u()">
                </div>

                <div class="form-group">
                    <label>–†–∞–∑–º–µ—Ä –ë–û–ú–ë–´: <span id="sd-bsize">60</span>px</label>
                    <input type="range" id="conf-bomb-size" min="40" max="150" step="5" value="60" oninput="document.getElementById('sd-bsize').innerText=this.value;u()">
                </div>
                
                <div class="form-group">
                    <label>‚ÜïÔ∏è –°–º–µ—â–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞: <span id="sd-pos">0</span>px</label>
                    <input type="range" id="conf-tpos" min="-50" max="50" step="2" value="0" oninput="document.getElementById('sd-pos').innerText=this.value;u()">
                </div>
            </div>

            <div class="form-group"><label>–®—Ä–∏—Ñ—Ç –∏–≥—Ä—ã</label>
                <select id="font-family" onchange="u()">
                    <option value="Ruslan Display">Ruslan Display (–°—Ç–∏–ª—å–Ω—ã–π)</option>
                    <option value="Press Start 2P">Press Start 2P (–ü–∏–∫—Å–µ–ª—å–Ω—ã–π)</option>
                    <option value="Lobster">Lobster (–†—É–∫–æ–ø–∏—Å–Ω—ã–π)</option>
                    <option value="Comfortaa">Comfortaa (–û–∫—Ä—É–≥–ª—ã–π)</option>
                    <option value="Roboto">Roboto (–°—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
                    <option value="Pacifico">Pacifico (–ö—É—Ä—Å–∏–≤)</option>
                    <option value="Arial">Arial</option>
                </select>
            </div>
            
            <div class="form-row">
                <div class="form-group"><label>–†–∞–∑–º–µ—Ä –í–æ–ø—Ä–æ—Å–∞</label><input type="number" id="fs-q" value="28" onchange="u()"></div>
                <div class="form-group"><label>–†–∞–∑–º–µ—Ä –û—Ç–≤–µ—Ç–∞</label><input type="number" id="fs-a" value="20" onchange="u()"></div>
            </div>
            
            <div class="form-group"><label>üé® –¶–≤–µ—Ç –§–æ–Ω–∞ –û–∫–Ω–∞</label><input type="color" id="col-win-bg" value="#1a1a1a" onchange="u()"></div>
            <div class="form-group"><label>‚ú® –¶–≤–µ—Ç –†–∞–º–∫–∏ / –ö–Ω–æ–ø–∫–∏</label><input type="color" id="col-border" value="#a29bfe" onchange="u()"></div>
            
            <div class="form-row">
                <div class="form-group" style="flex:1"><label>–¢–µ–∫—Å—Ç (–ü—Ä–µ–¥–º–µ—Ç)</label><input type="color" id="col-lt" value="#ffffff" onchange="u()"></div>
                <div class="form-group" style="flex:1"><label>–§–æ–Ω (–ü—Ä–µ–¥–º–µ—Ç)</label><input type="color" id="col-lb" value="#000000" onchange="u()"></div>
            </div>
            <div class="form-row">
                <div class="form-group" style="flex:1"><label>–ü—Ä–æ–≥—Ä–µ—Å—Å (–ù–∞—á–∞–ª–æ)</label><input type="color" id="col-p1" value="#9b59b6" onchange="u()"></div>
                <div class="form-group" style="flex:1"><label>–ü—Ä–æ–≥—Ä–µ—Å—Å (–ö–æ–Ω–µ—Ü)</label><input type="color" id="col-p2" value="#8e44ad" onchange="u()"></div>
            </div>
        </div>
        
        <div id="tab-text" class="section">
            <div class="form-group"><label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ–Ω—é</label><input type="text" id="tt" value="–ü–û–ô–ú–ê–ô –ü–†–ï–î–ú–ï–¢–´" onchange="u()"></div>
            <div class="form-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ –º–µ–Ω—é</label><textarea id="td" rows="2" onchange="u()">–ò—Å–ø–æ–ª—å–∑—É–π ‚Üê –∏–ª–∏ ‚Üí —á—Ç–æ–±—ã –ø–æ–π–º–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã. –ò–∑–±–µ–≥–∞–π –±–æ–º–± –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤!</textarea></div>
            <div class="form-group"><label>–¢–µ–∫—Å—Ç –ü–æ–±–µ–¥—ã</label><input type="text" id="tw" value="–ü–û–ë–ï–î–ê!" onchange="u()"></div>
            <div class="form-group"><label>–¢–µ–∫—Å—Ç –ü–æ—Ä–∞–∂–µ–Ω–∏—è</label><input type="text" id="tl" value="–û–π!" onchange="u()"></div>
        </div>
    </div>
    
    <div class="editor-footer">
        <button class="btn-generate" onclick="gen()">üöÄ –ü–û–õ–£–ß–ò–¢–¨ –ö–û–î</button>
    </div>
</div>

<div class="preview-area">
    <div id="game-preview-container"><iframe id="game-frame"></iframe></div>
</div>

<div id="modal-code" class="modal-overlay">
    <div class="code-modal">
        <h3>üéâ –ö–æ–¥ –≥–æ—Ç–æ–≤!</h3>
        <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ Genially (Insert -> Others).</p>
        <textarea id="final-code" readonly></textarea>
        <div class="modal-btns">
            <button class="btn-close" onclick="document.getElementById('modal-code').style.display='none'">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button class="btn-copy" onclick="copy()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
    </div>
</div>

<script>
// –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –°–°–´–õ–ö–ò –ò–ó –ó–ê–ü–†–û–°–ê
const def={
    h:"https://img.genially.com/684ea2da1b51060014c50e97/4e2c4c8a-5a17-4c32-95e1-7cc360b44a84.png",
    b:"https://img.genially.com/684ea2da1b51060014c50e97/91910846-d855-4c4b-8561-5ff0edaa87ad.png",
    l:"https://img.genially.com/684ea2da1b51060014c50e97/56159391-2288-48d7-8264-2e7f0aa2f799.gif",
    sk1:"https://img.genially.com/684ea2da1b51060014c50e97/33b8d640-53fd-4b63-b5df-f7df01a72b2f.png",
    sk2:"https://img.genially.com/684ea2da1b51060014c50e97/5857090c-baea-4b09-bb56-cda2472b1b19.png",
    qs:[{t:"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞",c:"–û—Ç–≤–µ—Ç",w:"–ù–∞–ø—Ä: –ê, –ë, –í"}]
};
const fonts={
    "Roboto":"https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap",
    "Pacifico":"https://fonts.googleapis.com/css2?family=Pacifico&display=swap",
    "Ruslan Display":"https://fonts.googleapis.com/css2?family=Ruslan+Display&display=swap",
    "Press Start 2P":"https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap",
    "Lobster":"https://fonts.googleapis.com/css2?family=Lobster&display=swap",
    "Comfortaa":"https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap",
    "Arial":""
};

let imgCache = { hero: null, bomb: null, life: null, skin1: null, skin2: null };

window.onload=()=>{
    document.getElementById('img-hero').value=def.h;document.getElementById('img-bomb').value=def.b;
    document.getElementById('img-life').value=def.l;document.getElementById('img-skin1').value=def.sk1;
    document.getElementById('img-skin2').value=def.sk2;def.qs.forEach(q=>addQuestion(q.t,q.c,q.w));u();
};
function switchTab(id){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));event.target.classList.add('active');document.getElementById('tab-'+id).classList.add('active');}

function addQuestion(t="",c="",w=""){
    const d=document.createElement('div');
    d.className='q-item';
    d.innerHTML=`
        <div class="btn-remove-q" title="–£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å" onclick="this.parentElement.remove();u()">√ó</div>
        <div style="margin-bottom:10px;">
            <label class="q-label" style="color:#636e72;">–í–æ–ø—Ä–æ—Å</label>
            <input class="qt" value="${t}" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" onchange="u()" style="width:100%;font-weight:600">
        </div>
        <div class="form-row">
            <div style="flex:1">
                <label class="q-label" style="color:#2ecc71;">–í–µ—Ä–Ω—ã–µ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                <input class="qc" value="${c}" placeholder="–ù–∞–ø—Ä: 2, 4, 6" style="border-color:#2ecc71;width:100%" onchange="u()">
            </div>
            <div style="flex:1">
                <label class="q-label" style="color:#e74c3c;">–ù–µ–≤–µ—Ä–Ω—ã–µ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                <input class="qw" value="${w}" placeholder="–ù–∞–ø—Ä: 1, 3, 5" style="border-color:#e74c3c;width:100%" onchange="u()">
            </div>
        </div>`;
    document.getElementById('questions-list').appendChild(d);
}

function encodeImg(input, key) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            imgCache[key] = e.target.result; 
            document.getElementById('img-' + key).value = "(–ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞)";
            u();
        }
        reader.readAsDataURL(file);
    }
}
function clearCache(key) { imgCache[key] = null; }

function getCfg(){
    const qs=[];document.querySelectorAll('.q-item').forEach(i=>{const t=i.querySelector('.qt').value;const c=i.querySelector('.qc').value.split(',').map(s=>s.trim()).filter(s=>s);const w=i.querySelector('.qw').value.split(',').map(s=>s.trim()).filter(s=>s);if(t)qs.push({text:t,correct:c,wrong:w});});
    return {
        sp:document.getElementById('conf-speed').value,
        fr:document.getElementById('conf-freq').value, 
        h: imgCache.hero || document.getElementById('img-hero').value,
        b: imgCache.bomb || document.getElementById('img-bomb').value,
        l: imgCache.life || document.getElementById('img-life').value,
        // –û–ë–ù–û–í–õ–ï–ù–û: –¢–ï–ü–ï–†–¨ –≠–¢–û SKIN1 –ò SKIN2, –ê –ù–ï CORRECT/WRONG
        i1: imgCache.skin1 || document.getElementById('img-skin1').value,
        i2: imgCache.skin2 || document.getElementById('img-skin2').value,
        
        isz: document.getElementById('conf-size').value,
        hsz: document.getElementById('conf-hero-size').value, 
        bsz: document.getElementById('conf-bomb-size').value, 
        tpos: document.getElementById('conf-tpos').value,
        
        qs:qs,fn:document.getElementById('font-family').value,fq:document.getElementById('fs-q').value,fa:document.getElementById('fs-a').value,
        bc:document.getElementById('col-border').value, 
        wbg:document.getElementById('col-win-bg').value,
        p1:document.getElementById('col-p1').value,p2:document.getElementById('col-p2').value,cl:document.getElementById('col-lt').value,lb:document.getElementById('col-lb').value,tt:document.getElementById('tt').value,td:document.getElementById('td').value,tw:document.getElementById('tw').value,tl:document.getElementById('tl').value,td:document.getElementById('td').value
    };
}
function u(){const c=getCfg();const h=build(c);document.getElementById('game-frame').src=URL.createObjectURL(new Blob([h],{type:'text/html'}));}
function gen(){const c=getCfg();document.getElementById('final-code').value=build(c);document.getElementById('modal-code').style.display='flex';}
function copy(){const t=document.getElementById("final-code");t.select();document.execCommand("copy");alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!");}

function build(c){
    const fUrl=fonts[c.fn]; const fLink=fUrl?`<link href="${fUrl}" rel="stylesheet">`:'';
    const qs=JSON.stringify(c.qs);
    
    // –ò–ì–†–û–í–û–ô –î–í–ò–ñ–û–ö V61 (RANDOM SKINS)
    let html = `<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<link href="${fUrl}" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;user-select:none}
html,body{width:100%;height:100%;background:transparent;font-family:'${c.fn}',sans-serif;margin:0;padding:0}
#GC{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}
:root{
    --c:${c.bc};--bg:${c.wbg};--p1:${c.p1};--p2:${c.p2};--fq:${c.fq}px;--fa:${c.fa}px;--cl:${c.cl};--lb:${c.lb};
    --isz:${c.isz}px; /* –†–ê–ó–ú–ï–† –û–¢–í–ï–¢–ê */
    --bsz:${c.bsz}px; /* –†–ê–ó–ú–ï–† –ë–û–ú–ë–´ */
    --hsz:${c.hsz}px; /* –†–ê–ó–ú–ï–† –ì–ï–†–û–Ø */
    --tpos:${c.tpos}px; /* –ü–û–ó–ò–¶–ò–Ø –¢–ï–ö–°–¢–ê */
}
#UI{position:absolute;top:0;left:0;width:100%;padding:15px;z-index:10;display:flex;flex-direction:column;gap:10px;pointer-events:none}
.tb{display:flex;align-items:center;justify-content:center;gap:15px;pointer-events:auto}
#PB{width:40px;height:40px;border-radius:50%;border:2px solid #fff;background:var(--c);color:#fff;font-weight:700;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:0.1s}
#PB:active{transform:scale(0.9)}
.pc{flex:1;max-width:600px;height:20px;background:rgba(0,0,0,0.5);border:2px solid rgba(255,255,255,0.8);border-radius:10px;overflow:hidden}
.pf{height:100%;background:linear-gradient(90deg,var(--p1),var(--p2));width:0%;transition:width 0.5s ease}
#QB{background:#111;border:2px solid var(--c);box-shadow:0 0 10px var(--c);color:#fff;border-radius:18px;padding:18px 24px;text-align:center;max-width:820px;margin:0 auto;box-sizing:border-box;pointer-events:auto;animation:pi .5s}
#QT{font-size:var(--fq);color:#fff;font-weight:700;text-shadow:0 0 5px var(--c);}
#LB{position:absolute;top:20px;right:20px;display:flex;gap:10px;pointer-events:none}
.h{width:50px;height:50px;background-size:contain;background-repeat:no-repeat;background-position:center;display:inline-block;filter:drop-shadow(0 2px 2px rgba(0,0,0,0.3))}
.h.br{animation:hba 2.5s forwards ease-out;z-index:100;position:relative}
@keyframes hba{0%{transform:scale(1);filter:brightness(1)}10%{transform:scale(1.1) rotate(-5deg);filter:brightness(2) sepia(1)}100%{transform:translateY(-150px) scale(1.2) rotate(-20deg);opacity:0}}

#H{
    position:absolute;bottom:30px;
    width:var(--hsz);
    height:var(--hsz); 
    background-repeat:no-repeat;background-position:center;background-size:contain;
    transform-origin:center bottom;transition:transform 0.1s linear;z-index:5
}

.f{
    position:absolute;top:-100px;
    display:flex;justify-content:center;align-items:center; 
    background-size:contain;background-repeat:no-repeat;background-position:center;
    will-change:top;z-index:4;
}
.f.is-bomb { width: var(--bsz); height: var(--bsz); }
.f.is-answer { width: var(--isz); height: var(--isz); }

.il{
    background:var(--lb);color:var(--cl);
    padding:4px 8px;border-radius:4px;
    font-size:var(--fa);font-weight:700;
    white-space:nowrap;
    text-shadow:0 0 2px #000;border:1px solid #ffffff50;
    position: relative; top: var(--tpos); 
}

.cf{position:absolute;width:10px;height:10px;background:#f00;top:-10px;z-index:25;pointer-events:none;opacity:0}
@keyframes cfa{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}
.ss{animation:sha 0.5s}
@keyframes sha{0%{transform:translate(1px,1px)}10%{transform:translate(-1px,-2px) rotate(-1deg)}30%{transform:translate(3px,2px)}50%{transform:translate(-1px,2px) rotate(-1deg)}70%{transform:translate(3px,1px) rotate(-1deg)}90%{transform:translate(1px,2px)}100%{transform:translate(1px,-2px) rotate(-1deg)}}
.ov{position:absolute;inset:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:20;transition:0.3s;padding:15px;box-sizing:border-box}
.ov.hd{opacity:0;pointer-events:none}

.md {
  background: var(--bg); border: 3px solid var(--c);
  box-shadow: 0 0 30px var(--c), inset 0 0 30px rgba(0,0,0,0.6);
  border-radius: 25px; width: 95%; max-width: 750px; height: auto; max-height: 90vh;
  overflow-y: auto; box-sizing: border-box; padding: 40px; color: #fff;
  display: flex; flex-direction: column; align-items: center; text-align: center; 
}
.md h1 { color: #fff; margin: 0 0 15px 0; font-size: 32px; text-transform: uppercase; text-shadow: 0 0 10px var(--c); width: 100%; }
.md p { color: #eee; font-size: 18px; margin: 0 0 30px 0; white-space: pre-line; line-height: 1.5; width: 100%; }
.game-btn {
  display: flex; align-items: center; justify-content: center;
  width: auto; max-width: 250px; min-width: 160px; height: 50px; padding: 0 30px;
  background: var(--c); border-radius: 50px; color: #fff; font-weight: 800; font-size: 18px;
  text-transform: uppercase; cursor: pointer; box-shadow: 0 0 15px var(--c);
  transition: all 0.1s; user-select: none; border: 2px solid #fff; line-height: 1 !important; 
}
.game-btn:hover { transform: scale(1.05); box-shadow: 0 0 25px var(--c); }
.game-btn:active { transform: scale(0.95); }
.ft{position:absolute;font-weight:700;font-size:24px;pointer-events:none;animation:fu 1s forwards;z-index:15;text-shadow:2px 2px 0 #000}
@keyframes fu{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-50px)}}
@keyframes pi{0%{transform:scale(0.8);opacity:0}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body><div id="GC"><div id="UI"><div class="tb"><button id="PB">||</button><div class="pc"><div id="PF" class="pf"></div></div></div><div id="LB"></div><div id="QB"><div id="QT">...</div></div></div><div id="H"></div><div id="O" class="ov"><div class="md"><h1 id="OT"></h1><p id="OD"></p><div id="OB" class="game-btn">OK</div></div></div></div>
<script>
(function(){
const C={li:"${c.l}",hi:"${c.h}",bi:"${c.b}",i1:"${c.i1}",i2:"${c.i2}",hs:6,fs:${c.sp},si:${c.fr},ml:3,qs:${qs},tx:{t:"${c.tt}",d:"${c.td}",w:"${c.tw}",l:"${c.tl}"}};
let s={rn:0,pa:0,qi:0,lv:C.ml,hx:0,hf:0,ao:[],lt:0,tm:0,af:0,k:{l:0,r:0}};
const D=document,E={c:D.getElementById('GC'),h:D.getElementById('H'),l:D.getElementById('LB'),qt:D.getElementById('QT'),pf:D.getElementById('PF'),o:D.getElementById('O'),ot:D.getElementById('OT'),od:D.getElementById('OD'),ob:D.getElementById('OB'),pb:D.getElementById('PB')};

const AC = window.AudioContext || window.webkitAudioContext;
const ac = new AC();
function tone(type, freq, dur, vol=0.1) {
    if(ac.state === 'suspended') ac.resume();
    const o = ac.createOscillator(); const g = ac.createGain();
    o.type = type; o.frequency.setValueAtTime(freq, ac.currentTime);
    g.gain.setValueAtTime(vol, ac.currentTime); g.gain.exponentialRampToValueAtTime(0.01, ac.currentTime + dur);
    o.connect(g); g.connect(ac.destination); o.start(); o.stop(ac.currentTime + dur);
}
function playBoom() {
    if(ac.state === 'suspended') ac.resume();
    const b = ac.createBuffer(1, ac.sampleRate * 0.5, ac.sampleRate);
    const d = b.getChannelData(0);
    for(let i=0; i<b.length; i++) d[i] = Math.random() * 2 - 1;
    const n = ac.createBufferSource(); n.buffer = b;
    const f = ac.createBiquadFilter(); f.type = 'lowpass'; f.frequency.value = 800; f.frequency.linearRampToValueAtTime(0, ac.currentTime + 0.5);
    const g = ac.createGain(); g.gain.setValueAtTime(1, ac.currentTime); g.gain.exponentialRampToValueAtTime(0.01, ac.currentTime + 0.5);
    n.connect(f); f.connect(g); g.connect(ac.destination); n.start();
}
function playWin() { [523.25, 659.25, 783.99, 1046.50].forEach((f, i) => setTimeout(() => tone('square', f, 0.3, 0.1), i * 100)); }
function playLose() {
    if(ac.state === 'suspended') ac.resume();
    const o = ac.createOscillator(); const g = ac.createGain();
    o.type = 'sawtooth'; o.frequency.setValueAtTime(200, ac.currentTime); o.frequency.linearRampToValueAtTime(50, ac.currentTime + 1);
    g.gain.setValueAtTime(0.2, ac.currentTime); g.gain.linearRampToValueAtTime(0, ac.currentTime + 1);
    o.connect(g); g.connect(ac.destination); o.start(); o.stop(ac.currentTime + 1);
}
function ps(k) {
    if (k === 'b') playBoom();
    else if (k === 'c') { tone('sine', 1046.5, 0.1); setTimeout(() => tone('sine', 1568, 0.2), 100); }
    else if (k === 'w') tone('sawtooth', 150, 0.3, 0.2);
    else if (k === 'l') playLose();
    else if (k === 'win') playWin();
}

function I(){E.h.style.backgroundImage='url("'+C.hi+'")';ev();rs();uu(1);so(0);}
function so(m){E.o.classList.remove('hd');if(m===0){stt(C.tx.t,C.tx.d,"–ò–ì–†–ê–¢–¨",sg);}else if(m===1){stt("–ü–∞—É–∑–∞","–ò–≥—Ä–∞ –Ω–∞ –ø–∞—É–∑–µ","–ü–†–û–î–û–õ–ñ–ò–¢–¨",tp);}else if(m===2){stt(C.tx.l,"","–ï–©–ï –†–ê–ó",sg);ps('l');}else if(m===3){stt(C.tx.w,"","–ï–©–ï –†–ê–ó",sg);ps('win');fc();}}
function stt(t,d,b,f){
    E.ot.innerText=t;E.od.innerText=d;E.ob.innerText=b;
    E.ob.onclick = () => { if(ac.state === 'suspended') ac.resume(); f(); };
}
function ho(){E.o.classList.add('hd');}
function sg(){if(s.af)cancelAnimationFrame(s.af);clearInterval(s.tm);D.querySelectorAll('.cf').forEach(c=>c.remove());s.lv=C.ml;s.qi=0;s.ao.forEach(o=>o.el.remove());s.ao=[];s.rn=1;s.pa=0;s.lt=performance.now();uu(1);lq(0);ho();s.af=requestAnimationFrame(gl);s.tm=setInterval(spl,C.si);}
function tp(){if(!s.rn)return;s.pa=!s.pa;if(s.pa){clearInterval(s.tm);so(1);}else{ho();s.lt=performance.now();s.tm=setInterval(spl,C.si);s.af=requestAnimationFrame(gl);}}
function lq(i){if(i>=C.qs.length){wg();return;}const q=C.qs[i];E.qt.textContent=q.text;const b=D.getElementById('QB');b.style.animation='none';b.offsetHeight;b.style.animation='pi 0.5s';}
function gl(t){if(!s.rn||s.pa)return;const dt=(t-s.lt)/16;s.lt=t;uh(dt);uo(dt);s.af=requestAnimationFrame(gl);}
function uh(dt){const sp=C.hs*dt,r=E.c.getBoundingClientRect(),hw=E.h.offsetWidth;if(s.k.l){s.hx-=sp;s.hf=1;}if(s.k.r){s.hx+=sp;s.hf=0;}if(s.hx<0)s.hx=0;if(s.hx>r.width-hw)s.hx=r.width-hw;E.h.style.left=s.hx+"px";E.h.style.transform='scaleX('+(s.hf?-1:1)+')';}
function uo(dt){const gr=E.c.getBoundingClientRect(),hr=E.h.getBoundingClientRect(),hb={l:hr.left+20,r:hr.right-20,t:hr.top+30,b:hr.bottom};for(let i=s.ao.length-1;i>=0;i--){if(i>=s.ao.length)break;const o=s.ao[i];if(!o)continue;o.y+=o.sp*dt;o.el.style.top=o.y+"px";if(o.y>gr.height){o.el.remove();s.ao.splice(i,1);continue;}const or=o.el.getBoundingClientRect();if(or.right>hb.l&&or.left<hb.r&&or.bottom>hb.t&&or.top<hb.b){hc(o,i);if(s.ao.length===0)break;}}}
function spl(){if(!s.rn||s.pa)return;if(s.qi>=C.qs.length)return;const q=C.qs[s.qi];if(!q)return;const r=Math.random();let t,tx,ic;
    if(r<0.1){t='b';}
    else if(r<0.5){t='a';ic=1;tx=q.correct[Math.floor(Math.random()*q.correct.length)];}
    else{t='a';ic=0;tx=q.wrong[Math.floor(Math.random()*q.wrong.length)];}
    cfo(t,tx,ic);
}
function cfo(t,tx,ic){const el=D.createElement('div');el.classList.add('f');
    if(t==='b'){
        el.classList.add('is-bomb');
        el.style.backgroundImage='url("'+C.bi+'")';
    }else{
        el.classList.add('is-answer');
        // RANDOM SKIN LOGIC HERE:
        const bg = Math.random() < 0.5 ? C.i1 : C.i2;
        el.style.backgroundImage='url("'+bg+'")';
        const l=D.createElement('div');l.className='il';l.textContent=tx;el.appendChild(l);
    }
    const gw=E.c.offsetWidth,x=Math.random()*(gw-110)+20;el.style.left=x+"px";E.c.appendChild(el);s.ao.push({el:el,x:x,y:-100,sp:Number(C.fs)+Math.random()*1.5,type:t,ic:ic});
}
function hc(o,i){o.el.remove();s.ao.splice(i,1);const hr=E.h.getBoundingClientRect(),cx=hr.left+hr.width/2;
if(o.type==='b'){ps('b');td();ss();sft("-1 ‚ù§Ô∏è",cx,hr.top,"red");}
else{if(o.ic){ps('c');sft("–í–µ—Ä–Ω–æ!",cx,hr.top,"#4caf50");nl();}else{ps('w');td();sft("–û—à–∏–±–∫–∞!",cx,hr.top,"orange");}}}
function nl(){s.ao.forEach(o=>o.el.remove());s.ao=[];s.qi++;uu();if(s.qi>=C.qs.length){wg();}else{lq(s.qi);}}
function td(){s.lv--;uu();if(s.lv<=0)go();}
function uu(r=0){const c=E.l;if(r){c.innerHTML='';for(let i=0;i<s.lv;i++){const h=D.createElement('div');h.className='h';h.style.backgroundImage='url("'+C.li+'")';c.appendChild(h);}}else{const ch=c.querySelectorAll('.h:not(.br)'),ct=s.lv;if(ch.length>ct){for(let i=0;i<ch.length-ct;i++){const hb=ch[ch.length-1-i];if(hb){hb.classList.add('br');hb.addEventListener('animationend',()=>hb.remove(),{once:true});}}}}const p=C.qs.length>0?(s.qi/C.qs.length)*100:0;E.pf.style.width=p+'%';}
function ss(){E.c.classList.remove('ss');void E.c.offsetWidth;E.c.classList.add('ss');}
function sft(t,x,y,c){const e=D.createElement('div');e.className='ft';e.textContent=t;e.style.color=c;e.style.left=x+"px";e.style.top=y+"px";D.body.appendChild(e);setTimeout(()=>e.remove(),1000);}
function go(){s.rn=0;if(s.af)cancelAnimationFrame(s.af);clearInterval(s.tm);so(2);}
function wg(){s.rn=0;if(s.af)cancelAnimationFrame(s.af);clearInterval(s.tm);E.pf.style.width='100%';so(3);}
function fc(){const c=['#d13447','#ffbf00','#263672','#7b2cbf','#8ac926','#1982c4'];for(let i=0;i<150;i++){const e=D.createElement('div');e.className='cf';e.style.backgroundColor=c[Math.floor(Math.random()*c.length)];e.style.left=Math.random()*100+'vw';const d=Math.random()*3+2;e.style.animation=\`cfa \${d}s linear forwards\`;e.style.animationDelay=Math.random()*2+'s';const s=Math.random()*10+5;e.style.width=s+'px';e.style.height=s*0.6+'px';E.c.appendChild(e);}}
function rs(){s.hx=(E.c.offsetWidth-100)/2;E.h.style.left=s.hx+"px";}
function ev(){window.addEventListener('resize',rs);window.addEventListener('keydown',e=>{if(e.code==='Space')tp();if(e.code==='ArrowLeft'||e.code==='KeyA')s.k.l=1;if(e.code==='ArrowRight'||e.code==='KeyD')s.k.r=1;});window.addEventListener('keyup',e=>{if(e.code==='ArrowLeft'||e.code==='KeyA')s.k.l=0;if(e.code==='ArrowRight'||e.code==='KeyD')s.k.r=0;});E.pb.addEventListener('click',tp);}
I();})();
<\/script></body></html>`;
    return html;
}
</script>
</body>
</html>
